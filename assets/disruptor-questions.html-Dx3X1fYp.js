import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as a,o as n,c as u,a as e,b as t,d as i,e as o}from"./app-Dl67cLp_.js";const p={},c=e("p",null,"Disruptor æ˜¯ä¸€ä¸ªç›¸å¯¹å†·é—¨ä¸€äº›çš„çŸ¥è¯†ç‚¹ï¼Œä¸è¿‡ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»å†ä¸­ç”¨åˆ°äº† Disruptor çš„è¯ï¼Œé‚£é¢è¯•ä¸­å°±å¾ˆå¯èƒ½ä¼šè¢«é—®åˆ°ã€‚",-1),d={href:"https://mp.weixin.qq.com/s/C5QMjwEb6pzXACqZsyqC4A",target:"_blank",rel:"noopener noreferrer"},l=e("figure",null,[e("img",{src:"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-interview-questions.png",alt:"",tabindex:"0"}),e("figcaption")],-1),g=e("p",null,"è¿™ç¯‡æ–‡ç« å¯ä»¥çœ‹ä½œæ˜¯å¯¹ Disruptor åšçš„ä¸€ä¸ªç®€å•æ€»ç»“ï¼Œæ¯ä¸ªé—®é¢˜éƒ½ä¸ä¼šæ‰¯å¤ªæ·±å…¥ï¼Œä¸»è¦é’ˆå¯¹é¢è¯•æˆ–è€…é€Ÿè§ˆ Disruptorã€‚",-1),h=e("h2",{id:"disruptor-æ˜¯ä»€ä¹ˆ",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#disruptor-æ˜¯ä»€ä¹ˆ"},[e("span",null,"Disruptor æ˜¯ä»€ä¹ˆï¼Ÿ")])],-1),m=e("p",null,"Disruptor æ˜¯ä¸€ä¸ªå¼€æºçš„é«˜æ€§èƒ½å†…å­˜é˜Ÿåˆ—ï¼Œè¯ç”Ÿåˆè¡·æ˜¯ä¸ºäº†è§£å†³å†…å­˜é˜Ÿåˆ—çš„æ€§èƒ½å’Œå†…å­˜å®‰å…¨é—®é¢˜ï¼Œç”±è‹±å›½å¤–æ±‡äº¤æ˜“å…¬å¸ LMAX å¼€å‘ã€‚",-1),f={href:"https://martinfowler.com/articles/lmax.html",target:"_blank",rel:"noopener noreferrer"},D=e("p",null,"LMAX å…¬å¸ 2010 å¹´åœ¨ QCon æ¼”è®²åï¼ŒDisruptor è·å¾—äº†ä¸šç•Œå…³æ³¨ï¼Œå¹¶è·å¾—äº† 2011 å¹´çš„ Oracle å®˜æ–¹çš„ Duke's Choice Awards(Duke é€‰æ‹©å¤§å¥–)ã€‚",-1),_=e("figure",null,[e("img",{src:"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/640.png",alt:"",tabindex:"0"}),e("figcaption")],-1),v=e("blockquote",null,[e("p",null,"â€œDuke é€‰æ‹©å¤§å¥–â€æ—¨åœ¨è¡¨å½°è¿‡å»ä¸€å¹´é‡Œå…¨çƒä¸ªäººæˆ–å…¬å¸å¼€å‘çš„ã€æœ€å…·å½±å“åŠ›çš„ Java æŠ€æœ¯åº”ç”¨ï¼Œç”±ç”²éª¨æ–‡å…¬å¸ä¸»åŠã€‚å«é‡‘é‡éå¸¸é«˜ï¼")],-1),k={href:"https://blogs.oracle.com/java/post/and-the-winners-arethe-dukes-choice-award%EF%BC%89",target:"_blank",rel:"noopener noreferrer"},b=e("figure",null,[e("img",{src:"https://oss.javaguide.cn/javaguide/image-20211015152323898.png",alt:"2011 å¹´çš„ Oracle å®˜æ–¹çš„ Duke's Choice Awards",tabindex:"0"}),e("figcaption",null,"2011 å¹´çš„ Oracle å®˜æ–¹çš„ Duke's Choice Awards")],-1),y=e("p",null,"Disruptor æä¾›çš„åŠŸèƒ½ä¼˜ç‚¹ç±»ä¼¼äº Kafkaã€RocketMQ è¿™ç±»åˆ†å¸ƒå¼é˜Ÿåˆ—ï¼Œä¸è¿‡ï¼Œå…¶ä½œä¸ºèŒƒå›´æ˜¯ JVM(å†…å­˜)ã€‚",-1),j={href:"https://github.com/LMAX-Exchange/disruptor",target:"_blank",rel:"noopener noreferrer"},q={href:"https://lmax-exchange.github.io/disruptor/user-guide/index.html",target:"_blank",rel:"noopener noreferrer"},S={href:"https://mp.weixin.qq.com/s/0iG5brK3bYF0BgSjX4jRiA",target:"_blank",rel:"noopener noreferrer"},C=o('<h2 id="ä¸ºä»€ä¹ˆè¦ç”¨-disruptor" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦ç”¨-disruptor"><span>ä¸ºä»€ä¹ˆè¦ç”¨ Disruptorï¼Ÿ</span></a></h2><p>Disruptor ä¸»è¦è§£å†³äº† JDK å†…ç½®çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—çš„æ€§èƒ½å’Œå†…å­˜å®‰å…¨é—®é¢˜ã€‚</p><p><strong>JDK ä¸­å¸¸è§çš„çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—å¦‚ä¸‹</strong>ï¼š</p><table><thead><tr><th>é˜Ÿåˆ—åå­—</th><th>é”</th><th>æ˜¯å¦æœ‰ç•Œ</th></tr></thead><tbody><tr><td><code>ArrayBlockingQueue</code></td><td>åŠ é”ï¼ˆ<code>ReentrantLock</code>ï¼‰</td><td>æœ‰ç•Œ</td></tr><tr><td><code>LinkedBlockingQueue</code></td><td>åŠ é”ï¼ˆ<code>ReentrantLock</code>ï¼‰</td><td>æœ‰ç•Œ</td></tr><tr><td><code>LinkedTransferQueue</code></td><td>æ— é”ï¼ˆ<code>CAS</code>ï¼‰</td><td>æ— ç•Œ</td></tr><tr><td><code>ConcurrentLinkedQueue</code></td><td>æ— é”ï¼ˆ<code>CAS</code>ï¼‰</td><td>æ— ç•Œ</td></tr></tbody></table><p>ä»ä¸Šè¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼šè¿™äº›é˜Ÿåˆ—è¦ä¸å°±æ˜¯åŠ é”æœ‰ç•Œï¼Œè¦ä¸å°±æ˜¯æ— é”æ— ç•Œã€‚è€ŒåŠ é”çš„çš„é˜Ÿåˆ—åŠ¿å¿…ä¼šå½±å“æ€§èƒ½ï¼Œæ— ç•Œçš„é˜Ÿåˆ—åˆå­˜åœ¨å†…å­˜æº¢å‡ºçš„é£é™©ã€‚</p><p>å› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸å»ºè®®ä½¿ç”¨ JDK å†…ç½®çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ã€‚</p><p><strong>Disruptor å°±ä¸ä¸€æ ·äº†ï¼å®ƒåœ¨æ— é”çš„æƒ…å†µä¸‹è¿˜èƒ½ä¿è¯é˜Ÿåˆ—æœ‰ç•Œï¼Œå¹¶ä¸”è¿˜æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</strong></p><p>ä¸‹é¢è¿™å¼ å›¾æ˜¯ Disruptor å®˜ç½‘æä¾›çš„ Disruptor å’Œ ArrayBlockingQueue çš„å»¶è¿Ÿç›´æ–¹å›¾å¯¹æ¯”ã€‚</p><figure><img src="https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-latency-histogram.png" alt="disruptor-latency-histogram" tabindex="0"><figcaption>disruptor-latency-histogram</figcaption></figure><p>Disruptor çœŸçš„å¾ˆå¿«ï¼Œå…³äºå®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«è¿™ä¸ªé—®é¢˜ï¼Œä¼šåœ¨åæ–‡ä»‹ç»åˆ°ã€‚</p><p>æ­¤å¤–ï¼ŒDisruptor è¿˜æä¾›äº†ä¸°å¯Œçš„æ‰©å±•åŠŸèƒ½æ¯”å¦‚æ”¯æŒæ‰¹é‡æ“ä½œã€æ”¯æŒå¤šç§ç­‰å¾…ç­–ç•¥ã€‚</p><h2 id="kafka-å’Œ-disruptor-ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#kafka-å’Œ-disruptor-ä»€ä¹ˆåŒºåˆ«"><span>Kafka å’Œ Disruptor ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span></a></h2><ul><li><strong>Kafka</strong>ï¼šåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€èˆ¬ç”¨åœ¨ç³»ç»Ÿæˆ–è€…æœåŠ¡ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ï¼Œè¿˜å¯ä»¥è¢«ç”¨ä½œæµå¼å¤„ç†å¹³å°ã€‚</li><li><strong>Disruptor</strong>ï¼šå†…å­˜çº§åˆ«çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€èˆ¬ç”¨åœ¨ç³»ç»Ÿå†…éƒ¨ä¸­çº¿ç¨‹é—´çš„æ¶ˆæ¯ä¼ é€’ã€‚</li></ul><h2 id="å“ªäº›ç»„ä»¶ç”¨åˆ°äº†-disruptor" tabindex="-1"><a class="header-anchor" href="#å“ªäº›ç»„ä»¶ç”¨åˆ°äº†-disruptor"><span>å“ªäº›ç»„ä»¶ç”¨åˆ°äº† Disruptorï¼Ÿ</span></a></h2><p>ç”¨åˆ° Disruptor çš„å¼€æºé¡¹ç›®è¿˜æ˜¯æŒºå¤šçš„ï¼Œè¿™é‡Œç®€å•ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p><ul><li><strong>Log4j2</strong>ï¼šLog4j2 æ˜¯ä¸€æ¬¾å¸¸ç”¨çš„æ—¥å¿—æ¡†æ¶ï¼Œå®ƒåŸºäº Disruptor æ¥å®ç°å¼‚æ­¥æ—¥å¿—ã€‚</li><li><strong>SOFATracer</strong>ï¼šSOFATracer æ˜¯èš‚èšé‡‘æœå¼€æºçš„åˆ†å¸ƒå¼åº”ç”¨é“¾è·¯è¿½è¸ªå·¥å…·ï¼Œå®ƒåŸºäº Disruptor æ¥å®ç°å¼‚æ­¥æ—¥å¿—ã€‚</li><li><strong>Storm</strong> : Storm æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼å®æ—¶è®¡ç®—ç³»ç»Ÿï¼Œå®ƒåŸºäº Disruptor æ¥å®ç°å·¥ä½œè¿›ç¨‹å†…å‘ç”Ÿçš„æ¶ˆæ¯ä¼ é€’ï¼ˆåŒä¸€ Storm èŠ‚ç‚¹ä¸Šçš„çº¿ç¨‹é—´ï¼Œæ— éœ€ç½‘ç»œé€šä¿¡ï¼‰ã€‚</li><li><strong>HBase</strong>ï¼šHBase æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åˆ—å­˜å‚¨æ•°æ®åº“ç³»ç»Ÿï¼Œå®ƒåŸºäº Disruptor æ¥æé«˜å†™å¹¶å‘æ€§èƒ½ã€‚</li><li>â€¦â€¦</li></ul><h2 id="disruptor-æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#disruptor-æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›"><span>Disruptor æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›ï¼Ÿ</span></a></h2><ul><li><strong>Event</strong>ï¼šä½ å¯ä»¥æŠŠ Event ç†è§£ä¸ºå­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ¶ˆè´¹çš„æ¶ˆæ¯å¯¹è±¡ã€‚</li><li><strong>EventFactory</strong>ï¼šäº‹ä»¶å·¥å‚ç”¨äºç”Ÿäº§äº‹ä»¶ï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ– <code>Disruptor</code> ç±»çš„æ—¶å€™éœ€è¦ç”¨åˆ°ã€‚</li><li><strong>EventHandler</strong>ï¼šEvent åœ¨å¯¹åº”çš„ Handler ä¸­è¢«å¤„ç†ï¼Œä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºç”Ÿäº§æ¶ˆè´¹è€…æ¨¡å‹ä¸­çš„æ¶ˆè´¹è€…ã€‚</li><li><strong>EventProcessor</strong>ï¼šEventProcessor æŒæœ‰ç‰¹å®šæ¶ˆè´¹è€…(Consumer)çš„ Sequenceï¼Œå¹¶æä¾›ç”¨äºè°ƒç”¨äº‹ä»¶å¤„ç†å®ç°çš„äº‹ä»¶å¾ªç¯(Event Loop)ã€‚</li><li><strong>Disruptor</strong>ï¼šäº‹ä»¶çš„ç”Ÿäº§å’Œæ¶ˆè´¹éœ€è¦ç”¨åˆ° <code>Disruptor</code> å¯¹è±¡ã€‚</li><li><strong>RingBuffer</strong>ï¼šRingBufferï¼ˆç¯å½¢æ•°ç»„ï¼‰ç”¨äºä¿å­˜äº‹ä»¶ã€‚</li><li><strong>WaitStrategy</strong>ï¼šç­‰å¾…ç­–ç•¥ã€‚å†³å®šäº†æ²¡æœ‰äº‹ä»¶å¯ä»¥æ¶ˆè´¹çš„æ—¶å€™ï¼Œäº‹ä»¶æ¶ˆè´¹è€…å¦‚ä½•ç­‰å¾…æ–°äº‹ä»¶çš„åˆ°æ¥ã€‚</li><li><strong>Producer</strong>ï¼šç”Ÿäº§è€…ï¼Œåªæ˜¯æ³›æŒ‡è°ƒç”¨ <code>Disruptor</code> å¯¹è±¡å‘å¸ƒäº‹ä»¶çš„ç”¨æˆ·ä»£ç ï¼ŒDisruptor æ²¡æœ‰å®šä¹‰ç‰¹å®šæ¥å£æˆ–ç±»å‹ã€‚</li><li><strong>ProducerType</strong>ï¼šæŒ‡å®šæ˜¯å•ä¸ªäº‹ä»¶å‘å¸ƒè€…æ¨¡å¼è¿˜æ˜¯å¤šä¸ªäº‹ä»¶å‘å¸ƒè€…æ¨¡å¼ï¼ˆå‘å¸ƒè€…å’Œç”Ÿäº§è€…çš„æ„æ€ç±»ä¼¼ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨å‘å¸ƒè€…ï¼‰ã€‚</li><li><strong>Sequencer</strong>ï¼šSequencer æ˜¯ Disruptor çš„çœŸæ­£æ ¸å¿ƒã€‚æ­¤æ¥å£æœ‰ä¸¤ä¸ªå®ç°ç±» <code>SingleProducerSequencer</code>ã€<code>MultiProducerSequencer</code> ï¼Œå®ƒä»¬å®šä¹‰åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´å¿«é€Ÿã€æ­£ç¡®åœ°ä¼ é€’æ•°æ®çš„å¹¶å‘ç®—æ³•ã€‚</li></ul><p>ä¸‹é¢è¿™å¼ å›¾æ‘˜è‡ª Disruptor å®˜ç½‘ï¼Œå±•ç¤ºäº† LMAX ç³»ç»Ÿä½¿ç”¨ Disruptor çš„ç¤ºä¾‹ã€‚</p><figure><img src="https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-models.png" alt="LMAX ç³»ç»Ÿä½¿ç”¨ Disruptor çš„ç¤ºä¾‹" tabindex="0"><figcaption>LMAX ç³»ç»Ÿä½¿ç”¨ Disruptor çš„ç¤ºä¾‹</figcaption></figure><h2 id="disruptor-ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#disruptor-ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›"><span>Disruptor ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</span></a></h2><p><strong>ç­‰å¾…ç­–ç•¥ï¼ˆWaitStrategyï¼‰</strong> å†³å®šäº†æ²¡æœ‰äº‹ä»¶å¯ä»¥æ¶ˆè´¹çš„æ—¶å€™ï¼Œäº‹ä»¶æ¶ˆè´¹è€…å¦‚ä½•ç­‰å¾…æ–°äº‹ä»¶çš„åˆ°æ¥ã€‚</p><p>å¸¸è§çš„ç­‰å¾…ç­–ç•¥æœ‰ä¸‹é¢è¿™äº›ï¼š</p><figure><img src="https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/DisruptorWaitStrategy.png" alt="Disruptor ç­‰å¾…ç­–ç•¥" tabindex="0"><figcaption>Disruptor ç­‰å¾…ç­–ç•¥</figcaption></figure><ul><li><code>BlockingWaitStrategy</code>ï¼šåŸºäº <code>ReentrantLock</code>+<code>Condition</code> æ¥å®ç°ç­‰å¾…å’Œå”¤é†’æ“ä½œï¼Œå®ç°ä»£ç éå¸¸ç®€å•ï¼Œæ˜¯ Disruptor é»˜è®¤çš„ç­‰å¾…ç­–ç•¥ã€‚è™½ç„¶æœ€æ…¢ï¼Œä½†ä¹Ÿæ˜¯ CPU ä½¿ç”¨ç‡æœ€ä½å’Œæœ€ç¨³å®šçš„é€‰é¡¹ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨ï¼›</li><li><code>BusySpinWaitStrategy</code>ï¼šæ€§èƒ½å¾ˆå¥½ï¼Œå­˜åœ¨æŒç»­è‡ªæ—‹çš„é£é™©ï¼Œä½¿ç”¨ä¸å½“ä¼šé€ æˆ CPU è´Ÿè½½ 100%ï¼Œæ…ç”¨ï¼›</li><li><code>LiteBlockingWaitStrategy</code>ï¼šåŸºäº <code>BlockingWaitStrategy</code> çš„è½»é‡çº§ç­‰å¾…ç­–ç•¥ï¼Œåœ¨æ²¡æœ‰é”ç«äº‰çš„æ—¶å€™ä¼šçœå»å”¤é†’æ“ä½œï¼Œä½†æ˜¯ä½œè€…è¯´æµ‹è¯•ä¸å……åˆ†ï¼Œå› æ­¤ä¸å»ºè®®ä½¿ç”¨;</li><li><code>TimeoutBlockingWaitStrategy</code>ï¼šå¸¦è¶…æ—¶çš„ç­‰å¾…ç­–ç•¥ï¼Œè¶…æ—¶åä¼šæ‰§è¡Œä¸šåŠ¡æŒ‡å®šçš„å¤„ç†é€»è¾‘;</li><li><code>LiteTimeoutBlockingWaitStrategy</code>ï¼šåŸºäº<code>TimeoutBlockingWaitStrategy</code>çš„ç­–ç•¥ï¼Œå½“æ²¡æœ‰é”ç«äº‰çš„æ—¶å€™ä¼šçœå»å”¤é†’æ“ä½œ;</li><li><code>SleepingWaitStrategy</code>ï¼šä¸‰æ®µå¼ç­–ç•¥ï¼Œç¬¬ä¸€é˜¶æ®µè‡ªæ—‹ï¼Œç¬¬äºŒé˜¶æ®µæ‰§è¡Œ Thread.yield è®©å‡º CPUï¼Œç¬¬ä¸‰é˜¶æ®µç¡çœ æ‰§è¡Œæ—¶é—´ï¼Œåå¤çš„ç¡çœ ï¼›</li><li><code>YieldingWaitStrategy</code>ï¼šäºŒæ®µå¼ç­–ç•¥ï¼Œç¬¬ä¸€é˜¶æ®µè‡ªæ—‹ï¼Œç¬¬äºŒé˜¶æ®µæ‰§è¡Œ Thread.yield äº¤å‡º CPU;</li><li><code>PhasedBackoffWaitStrategy</code>ï¼šå››æ®µå¼ç­–ç•¥ï¼Œç¬¬ä¸€é˜¶æ®µè‡ªæ—‹æŒ‡å®šæ¬¡æ•°ï¼Œç¬¬äºŒé˜¶æ®µè‡ªæ—‹æŒ‡å®šæ—¶é—´ï¼Œç¬¬ä¸‰é˜¶æ®µæ‰§è¡Œ <code>Thread.yield</code> äº¤å‡º CPUï¼Œç¬¬å››é˜¶æ®µè°ƒç”¨æˆå‘˜å˜é‡çš„<code>waitFor</code>æ–¹æ³•ï¼Œè¯¥æˆå‘˜å˜é‡å¯ä»¥è¢«è®¾ç½®ä¸º<code>BlockingWaitStrategy</code>ã€<code>LiteBlockingWaitStrategy</code>ã€<code>SleepingWaitStrategy</code>ä¸‰ä¸ªä¸­çš„ä¸€ä¸ªã€‚</li></ul><h2 id="disruptor-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«" tabindex="-1"><a class="header-anchor" href="#disruptor-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"><span>Disruptor ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ</span></a></h2><ul><li><strong>RingBufferï¼ˆç¯å½¢æ•°ç»„ï¼‰</strong> : Disruptor å†…éƒ¨çš„ RingBuffer æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„ã€‚ç”±äºè¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹åŒ–æ—¶ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºï¼Œå› æ­¤è¿™äº›å…ƒç´ çš„å†…å­˜åœ°å€ä¸€èˆ¬æ¥è¯´æ˜¯è¿ç»­çš„ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå½“ç”Ÿäº§è€…ä¸æ–­å¾€ RingBuffer ä¸­æ’å…¥æ–°çš„äº‹ä»¶å¯¹è±¡æ—¶ï¼Œè¿™äº›äº‹ä»¶å¯¹è±¡çš„å†…å­˜åœ°å€å°±èƒ½å¤Ÿä¿æŒè¿ç»­ï¼Œä»è€Œåˆ©ç”¨ CPU ç¼“å­˜çš„å±€éƒ¨æ€§åŸç†ï¼Œå°†ç›¸é‚»çš„äº‹ä»¶å¯¹è±¡ä¸€èµ·åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œæé«˜ç¨‹åºçš„æ€§èƒ½ã€‚è¿™ç±»ä¼¼äº MySQL çš„é¢„è¯»æœºåˆ¶ï¼Œå°†è¿ç»­çš„å‡ ä¸ªé¡µé¢„è¯»åˆ°å†…å­˜é‡Œã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒRingBuffer åŸºäºæ•°ç»„è¿˜æ”¯æŒæ‰¹é‡æ“ä½œï¼ˆä¸€æ¬¡å¤„ç†å¤šä¸ªå…ƒç´ ï¼‰ã€è¿˜å¯ä»¥é¿å…é¢‘ç¹çš„å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶ï¼ˆRingBuffer æ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„æ•°ç»„ï¼Œå½“å‘æ•°ç»„ä¸­æ·»åŠ æ–°å…ƒç´ æ—¶ï¼Œå¦‚æœæ•°ç»„å·²æ»¡ï¼Œåˆ™æ–°å…ƒç´ å°†è¦†ç›–æ‰æœ€æ—§çš„å…ƒç´ ï¼‰ã€‚</li><li><strong>é¿å…äº†ä¼ªå…±äº«é—®é¢˜</strong>ï¼šCPU ç¼“å­˜å†…éƒ¨æ˜¯æŒ‰ç…§ Cache Lineï¼ˆç¼“å­˜è¡Œï¼‰ç®¡ç†çš„ï¼Œä¸€èˆ¬çš„ Cache Line å¤§å°åœ¨ 64 å­—èŠ‚å·¦å³ã€‚Disruptor ä¸ºäº†ç¡®ä¿ç›®æ ‡å­—æ®µç‹¬å ä¸€ä¸ª Cache Lineï¼Œä¼šåœ¨ç›®æ ‡å­—æ®µå‰åå¢åŠ å­—èŠ‚å¡«å……ï¼ˆå‰ 56 ä¸ªå­—èŠ‚å’Œå 56 ä¸ªå­—èŠ‚ï¼‰ï¼Œè¿™æ ·å¯ä»¥é¿å… Cache Line çš„ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰é—®é¢˜ã€‚åŒæ—¶ï¼Œä¸ºäº†è®© RingBuffer å­˜æ”¾æ•°æ®çš„æ•°ç»„ç‹¬å ç¼“å­˜è¡Œï¼Œæ•°ç»„çš„è®¾è®¡ä¸º æ— æ•ˆå¡«å……ï¼ˆ128 å­—èŠ‚ï¼‰+ æœ‰æ•ˆæ•°æ®ã€‚</li><li><strong>æ— é”è®¾è®¡</strong>ï¼šDisruptor é‡‡ç”¨æ— é”è®¾è®¡ï¼Œé¿å…äº†ä¼ ç»Ÿé”æœºåˆ¶å¸¦æ¥çš„ç«äº‰å’Œå»¶è¿Ÿã€‚Disruptor çš„æ— é”å®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œä¸»è¦æ˜¯åŸºäº CASã€å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰ã€RingBuffer ç­‰æŠ€æœ¯å®ç°çš„ã€‚</li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒDisruptor ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¦‚æ­¤å¿«ï¼Œæ˜¯åŸºäºä¸€ç³»åˆ—ä¼˜åŒ–ç­–ç•¥çš„ç»¼åˆä½œç”¨ï¼Œæ—¢å……åˆ†åˆ©ç”¨äº†ç°ä»£ CPU ç¼“å­˜ç»“æ„çš„ç‰¹ç‚¹ï¼Œåˆé¿å…äº†å¸¸è§çš„å¹¶å‘é—®é¢˜å’Œæ€§èƒ½ç“¶é¢ˆã€‚</p>',28),x={href:"https://qin.news/disruptor/",target:"_blank",rel:"noopener noreferrer"},B={href:"https://tech.meituan.com/2016/11/18/disruptor.html",target:"_blank",rel:"noopener noreferrer"},L=o('<p>ğŸŒˆ è¿™é‡Œé¢å¤–è¡¥å……ä¸€ç‚¹ï¼š<strong>æ•°ç»„ä¸­å¯¹è±¡å…ƒç´ åœ°å€è¿ç»­ä¸ºä»€ä¹ˆå¯ä»¥æé«˜æ€§èƒ½ï¼Ÿ</strong></p><p>CPU ç¼“å­˜æ˜¯é€šè¿‡å°†æœ€è¿‘ä½¿ç”¨çš„æ•°æ®å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜ä¸­æ¥å®ç°æ›´å¿«çš„è¯»å–é€Ÿåº¦ï¼Œå¹¶ä½¿ç”¨é¢„å–æœºåˆ¶æå‰åŠ è½½ç›¸é‚»å†…å­˜çš„æ•°æ®ä»¥åˆ©ç”¨å±€éƒ¨æ€§åŸç†ã€‚</p><p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼ŒCPU ä¸»è¦è®¿é—®é«˜é€Ÿç¼“å­˜å’Œå†…å­˜ã€‚é«˜é€Ÿç¼“å­˜æ˜¯ä¸€ç§é€Ÿåº¦éå¸¸å¿«ã€å®¹é‡ç›¸å¯¹è¾ƒå°çš„å†…å­˜ï¼Œé€šå¸¸è¢«åˆ†ä¸ºå¤šçº§ç¼“å­˜ï¼Œå…¶ä¸­ L1ã€L2ã€L3 åˆ†åˆ«è¡¨ç¤ºä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜ã€ä¸‰çº§ç¼“å­˜ã€‚è¶Šé è¿‘ CPU çš„ç¼“å­˜ï¼Œé€Ÿåº¦è¶Šå¿«ï¼Œå®¹é‡ä¹Ÿè¶Šå°ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå†…å­˜å®¹é‡ç›¸å¯¹è¾ƒå¤§ï¼Œä½†é€Ÿåº¦è¾ƒæ…¢ã€‚</p><figure><img src="https://oss.javaguide.cn/github/javaguide/java/concurrent/cpu-cache.png" alt="CPU ç¼“å­˜æ¨¡å‹ç¤ºæ„å›¾" tabindex="0"><figcaption>CPU ç¼“å­˜æ¨¡å‹ç¤ºæ„å›¾</figcaption></figure><p>ä¸ºäº†åŠ é€Ÿæ•°æ®çš„è¯»å–è¿‡ç¨‹ï¼ŒCPU ä¼šå…ˆå°†æ•°æ®ä»å†…å­˜ä¸­åŠ è½½åˆ°é«˜é€Ÿç¼“å­˜ä¸­ï¼Œå¦‚æœä¸‹ä¸€æ¬¡éœ€è¦è®¿é—®ç›¸åŒçš„æ•°æ®ï¼Œå°±å¯ä»¥ç›´æ¥ä»é«˜é€Ÿç¼“å­˜ä¸­è¯»å–ï¼Œè€Œä¸éœ€è¦å†æ¬¡è®¿é—®å†…å­˜ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ <strong>ç¼“å­˜å‘½ä¸­</strong> ã€‚å¦å¤–ï¼Œä¸ºäº†åˆ©ç”¨ <strong>å±€éƒ¨æ€§åŸç†</strong> ï¼ŒCPU è¿˜ä¼šæ ¹æ®ä¹‹å‰è®¿é—®çš„å†…å­˜åœ°å€é¢„å–ç›¸é‚»çš„å†…å­˜æ•°æ®ï¼Œå› ä¸ºåœ¨ç¨‹åºä¸­ï¼Œè¿ç»­çš„å†…å­˜åœ°å€é€šå¸¸ä¼šè¢«é¢‘ç¹è®¿é—®åˆ°ï¼Œè¿™æ ·åšå¯ä»¥æé«˜æ•°æ®çš„ç¼“å­˜å‘½ä¸­ç‡ï¼Œè¿›è€Œæé«˜ç¨‹åºçš„æ€§èƒ½ã€‚</p><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ"><span>å‚è€ƒ</span></a></h2>',6),A={href:"http://wuwenliang.net/2022/02/28/Disruptor",target:"_blank",rel:"noopener noreferrer"},w={href:"https://time.geekbang.org/column/article/98134",target:"_blank",rel:"noopener noreferrer"},P=e("figure",null,[e("img",{src:"https://oss.javaguide.cn/github/javaguide/gongzhonghaoxuanchuan.png",alt:"JavaGuide å®˜æ–¹å…¬ä¼—å·",tabindex:"0"}),e("figcaption",null,"JavaGuide å®˜æ–¹å…¬ä¼—å·")],-1);function M(T,W){const r=a("ExternalLinkIcon");return n(),u("div",null,[c,e("p",null,[t("ä¸€ä½çƒå‹ä¹‹å‰æŠ•ç¨¿çš„é¢ç»ï¼ˆç¤¾æ‹›ï¼‰ä¸­å°±æ¶‰åŠä¸€äº› Disruptor çš„é—®é¢˜ï¼Œæ–‡ç« ä¼ é€é—¨ï¼š"),e("a",d,[t("åœ†æ¢¦ï¼é¡ºåˆ©æ‹¿åˆ°å­—èŠ‚ã€æ·˜å®ã€æ‹¼å¤šå¤šç­‰å¤§å‚ offerï¼"),i(r)]),t(" ã€‚")]),l,g,h,m,e("p",null,[t("æ ¹æ® Disruptor å®˜æ–¹ä»‹ç»ï¼ŒåŸºäº Disruptor å¼€å‘çš„ç³»ç»Ÿ LMAXï¼ˆæ–°çš„é›¶å”®é‡‘èäº¤æ˜“å¹³å°ï¼‰ï¼Œå•çº¿ç¨‹å°±èƒ½æ”¯æ’‘æ¯ç§’ 600 ä¸‡è®¢å•ã€‚Martin Fowler åœ¨ 2011 å¹´å†™çš„ä¸€ç¯‡æ–‡ç«  "),e("a",f,[t("The LMAX Architecture"),i(r)]),t(" ä¸­ä¸“é—¨ä»‹ç»è¿‡è¿™ä¸ª LMAX ç³»ç»Ÿçš„æ¶æ„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ã€‚ã€‚")]),D,_,v,e("p",null,[t("æˆ‘ä¸“é—¨æ‰¾åˆ°äº† Oracle å®˜æ–¹å½“å¹´é¢å¸ƒè·å¾— Duke's Choice Awards é¡¹ç›®çš„é‚£ç¯‡æ–‡ç« ï¼ˆæ–‡ç« åœ°å€ï¼š"),e("a",k,[t("https://blogs.oracle.com/java/post/and-the-winners-arethe-dukes-choice-awardï¼‰"),i(r)]),t(" ã€‚ä»æ–‡ä¸­å¯ä»¥çœ‹å‡ºï¼ŒåŒå¹´è·å¾—æ­¤å¤§å¥–è£èª‰çš„è¿˜æœ‰å¤§åé¼é¼çš„ Nettyã€JRebel ç­‰é¡¹ç›®ã€‚")]),b,y,e("ul",null,[e("li",null,[t("Github åœ°å€ï¼š"),e("a",j,[t("https://github.com/LMAX-Exchange/disruptor"),i(r)])]),e("li",null,[t("å®˜æ–¹æ•™ç¨‹ï¼š "),e("a",q,[t("https://lmax-exchange.github.io/disruptor/user-guide/index.html"),i(r)])])]),e("p",null,[t("å…³äºå¦‚ä½•åœ¨ Spring Boot é¡¹ç›®ä¸­ä½¿ç”¨ Disruptorï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š"),e("a",S,[t("Spring Boot + Disruptor å®æˆ˜å…¥é—¨"),i(r)]),t(" ã€‚")]),C,e("p",null,[t("å…³äº Disruptor é«˜æ€§èƒ½é˜Ÿåˆ—åŸç†çš„è¯¦ç»†ä»‹ç»ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š"),e("a",x,[t("Disruptor é«˜æ€§èƒ½é˜Ÿåˆ—åŸç†æµ…æ"),i(r)]),t(" ï¼ˆå‚è€ƒäº†ç¾å›¢æŠ€æœ¯å›¢é˜Ÿçš„"),e("a",B,[t("é«˜æ€§èƒ½é˜Ÿåˆ—â€”â€”Disruptor"),i(r)]),t("è¿™ç¯‡æ–‡ç« ï¼‰ã€‚")]),L,e("ul",null,[e("li",null,[t("Disruptor é«˜æ€§èƒ½ä¹‹é“-ç­‰å¾…ç­–ç•¥ï¼š<"),e("a",A,[t("http://wuwenliang.net/2022/02/28/Disruptor"),i(r)]),t(" é«˜æ€§èƒ½ä¹‹é“-ç­‰å¾…ç­–ç•¥/>")]),e("li",null,[t("ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹- 40 | æ¡ˆä¾‹åˆ†æï¼ˆä¸‰ï¼‰ï¼šé«˜æ€§èƒ½é˜Ÿåˆ— Disruptorï¼š"),e("a",w,[t("https://time.geekbang.org/column/article/98134"),i(r)])])]),P])}const U=s(p,[["render",M],["__file","disruptor-questions.html.vue"]]),X=JSON.parse(`{"path":"/high-performance/message-queue/disruptor-questions.html","title":"Disruptorå¸¸è§é—®é¢˜æ€»ç»“","lang":"zh-CN","frontmatter":{"title":"Disruptorå¸¸è§é—®é¢˜æ€»ç»“","category":"é«˜æ€§èƒ½","tag":["æ¶ˆæ¯é˜Ÿåˆ—"],"gitInclude":["../../snippets/article-footer.snippet.md"],"description":"Disruptor æ˜¯ä¸€ä¸ªç›¸å¯¹å†·é—¨ä¸€äº›çš„çŸ¥è¯†ç‚¹ï¼Œä¸è¿‡ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»å†ä¸­ç”¨åˆ°äº† Disruptor çš„è¯ï¼Œé‚£é¢è¯•ä¸­å°±å¾ˆå¯èƒ½ä¼šè¢«é—®åˆ°ã€‚ ä¸€ä½çƒå‹ä¹‹å‰æŠ•ç¨¿çš„é¢ç»ï¼ˆç¤¾æ‹›ï¼‰ä¸­å°±æ¶‰åŠä¸€äº› Disruptor çš„é—®é¢˜ï¼Œæ–‡ç« ä¼ é€é—¨ï¼šåœ†æ¢¦ï¼é¡ºåˆ©æ‹¿åˆ°å­—èŠ‚ã€æ·˜å®ã€æ‹¼å¤šå¤šç­‰å¤§å‚ offerï¼ ã€‚ è¿™ç¯‡æ–‡ç« å¯ä»¥çœ‹ä½œæ˜¯å¯¹ Disruptor åšçš„ä¸€ä¸ªç®€å•æ€»ç»“ï¼Œæ¯ä¸ªé—®é¢˜éƒ½ä¸ä¼šæ‰¯å¤ª...","head":[["meta",{"property":"og:url","content":"https://javaguide.cn/learning/high-performance/message-queue/disruptor-questions.html"}],["meta",{"property":"og:site_name","content":"Mua'dib Guide "}],["meta",{"property":"og:title","content":"Disruptorå¸¸è§é—®é¢˜æ€»ç»“"}],["meta",{"property":"og:description","content":"Disruptor æ˜¯ä¸€ä¸ªç›¸å¯¹å†·é—¨ä¸€äº›çš„çŸ¥è¯†ç‚¹ï¼Œä¸è¿‡ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»å†ä¸­ç”¨åˆ°äº† Disruptor çš„è¯ï¼Œé‚£é¢è¯•ä¸­å°±å¾ˆå¯èƒ½ä¼šè¢«é—®åˆ°ã€‚ ä¸€ä½çƒå‹ä¹‹å‰æŠ•ç¨¿çš„é¢ç»ï¼ˆç¤¾æ‹›ï¼‰ä¸­å°±æ¶‰åŠä¸€äº› Disruptor çš„é—®é¢˜ï¼Œæ–‡ç« ä¼ é€é—¨ï¼šåœ†æ¢¦ï¼é¡ºåˆ©æ‹¿åˆ°å­—èŠ‚ã€æ·˜å®ã€æ‹¼å¤šå¤šç­‰å¤§å‚ offerï¼ ã€‚ è¿™ç¯‡æ–‡ç« å¯ä»¥çœ‹ä½œæ˜¯å¯¹ Disruptor åšçš„ä¸€ä¸ªç®€å•æ€»ç»“ï¼Œæ¯ä¸ªé—®é¢˜éƒ½ä¸ä¼šæ‰¯å¤ª..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-interview-questions.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-23T08:44:05.000Z"}],["meta",{"property":"article:author","content":"Guide"}],["meta",{"property":"article:tag","content":"æ¶ˆæ¯é˜Ÿåˆ—"}],["meta",{"property":"article:modified_time","content":"2024-02-23T08:44:05.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Disruptorå¸¸è§é—®é¢˜æ€»ç»“\\",\\"image\\":[\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-interview-questions.png\\",\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/640.png\\",\\"https://oss.javaguide.cn/javaguide/image-20211015152323898.png\\",\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-latency-histogram.png\\",\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-models.png\\",\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/DisruptorWaitStrategy.png\\",\\"https://oss.javaguide.cn/github/javaguide/java/concurrent/cpu-cache.png\\"],\\"dateModified\\":\\"2024-02-23T08:44:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Guide\\",\\"url\\":\\"https://javaguide.cn/article/\\"}]}"]]},"headers":[{"level":2,"title":"Disruptor æ˜¯ä»€ä¹ˆï¼Ÿ","slug":"disruptor-æ˜¯ä»€ä¹ˆ","link":"#disruptor-æ˜¯ä»€ä¹ˆ","children":[]},{"level":2,"title":"ä¸ºä»€ä¹ˆè¦ç”¨ Disruptorï¼Ÿ","slug":"ä¸ºä»€ä¹ˆè¦ç”¨-disruptor","link":"#ä¸ºä»€ä¹ˆè¦ç”¨-disruptor","children":[]},{"level":2,"title":"Kafka å’Œ Disruptor ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","slug":"kafka-å’Œ-disruptor-ä»€ä¹ˆåŒºåˆ«","link":"#kafka-å’Œ-disruptor-ä»€ä¹ˆåŒºåˆ«","children":[]},{"level":2,"title":"å“ªäº›ç»„ä»¶ç”¨åˆ°äº† Disruptorï¼Ÿ","slug":"å“ªäº›ç»„ä»¶ç”¨åˆ°äº†-disruptor","link":"#å“ªäº›ç»„ä»¶ç”¨åˆ°äº†-disruptor","children":[]},{"level":2,"title":"Disruptor æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›ï¼Ÿ","slug":"disruptor-æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›","link":"#disruptor-æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›","children":[]},{"level":2,"title":"Disruptor ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ","slug":"disruptor-ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›","link":"#disruptor-ç­‰å¾…ç­–ç•¥æœ‰å“ªäº›","children":[]},{"level":2,"title":"Disruptor ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ","slug":"disruptor-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«","link":"#disruptor-ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«","children":[]},{"level":2,"title":"å‚è€ƒ","slug":"å‚è€ƒ","link":"#å‚è€ƒ","children":[]}],"git":{"createdTime":1683197604000,"updatedTime":1708677845000,"contributors":[{"name":"Guide","email":"koushuangbwcx@163.com","commits":7},{"name":"Mr.Hope","email":"mister-hope@outlook.com","commits":6},{"name":"2382546457","email":"2382546457@qq.com","commits":1}]},"readingTime":{"minutes":9.09,"words":2726},"filePathRelative":"high-performance/message-queue/disruptor-questions.md","localizedDate":"2023å¹´5æœˆ4æ—¥","excerpt":"<p>Disruptor æ˜¯ä¸€ä¸ªç›¸å¯¹å†·é—¨ä¸€äº›çš„çŸ¥è¯†ç‚¹ï¼Œä¸è¿‡ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç»å†ä¸­ç”¨åˆ°äº† Disruptor çš„è¯ï¼Œé‚£é¢è¯•ä¸­å°±å¾ˆå¯èƒ½ä¼šè¢«é—®åˆ°ã€‚</p>\\n<p>ä¸€ä½çƒå‹ä¹‹å‰æŠ•ç¨¿çš„é¢ç»ï¼ˆç¤¾æ‹›ï¼‰ä¸­å°±æ¶‰åŠä¸€äº› Disruptor çš„é—®é¢˜ï¼Œæ–‡ç« ä¼ é€é—¨ï¼š<a href=\\"https://mp.weixin.qq.com/s/C5QMjwEb6pzXACqZsyqC4A\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">åœ†æ¢¦ï¼é¡ºåˆ©æ‹¿åˆ°å­—èŠ‚ã€æ·˜å®ã€æ‹¼å¤šå¤šç­‰å¤§å‚ offerï¼</a> ã€‚</p>\\n<figure><img src=\\"https://oss.javaguide.cn/github/javaguide/high-performance/message-queue/disruptor-interview-questions.png\\" alt=\\"\\" tabindex=\\"0\\"><figcaption></figcaption></figure>","autoDesc":true}`);export{U as comp,X as data};
